<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World's Best Event Map</title>
    <!-- Import high-performance map library -->
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
        }
        #map { height: 600px; width: 100%; max-width: 800px; }
        #form-container, #timeline {
            margin-top: 10px;
            width: 100%;
            max-width: 800px;
        }
        #timeline {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        input, textarea, button {
            padding: 8px;
            font-size: 1rem;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .alert {
            color: red;
            font-size: 0.9rem;
            display: none;
        }
    </style>
</head>
<body>
    <h2>World's Best Event Map</h2>
    <div id="map"></div>

    <div id="form-container">
        <div id="alert" class="alert"></div>
        <label>Latitude: <input type="text" id="lat" placeholder="Enter Latitude"></label>
        <label>Longitude: <input type="text" id="lng" placeholder="Enter Longitude"></label>
        <label>Date: <input type="text" id="date" placeholder="Enter Date (e.g., 2022-04-15)"></label>
        <label>Event Name: <input type="text" id="event-name" placeholder="Enter Event Name"></label>
        <label>Message: <textarea id="message" placeholder="Enter a message for this location"></textarea></label>
        <label>Image URL: <input type="text" id="image-url" placeholder="Enter Image URL (optional)"></label>
        <button onclick="addLocation()">Add Location</button>
    </div>

    <div id="timeline">
        <!-- Placeholder for timeline slider for events by date -->
        <label>View Events by Date: <input type="range" id="date-slider" min="0" max="100" /></label>
    </div>

    <script src="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js"></script>
    <script>
        mapboxgl.accessToken = 'YOUR_MAPBOX_ACCESS_TOKEN';
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [0, 20],
            zoom: 2
        });

        const locations = [];

        function showAlert(message) {
            const alertBox = document.getElementById("alert");
            alertBox.style.display = "block";
            alertBox.innerText = message;
            setTimeout(() => alertBox.style.display = "none", 3000);
        }

        function addLocation() {
            const lat = parseFloat(document.getElementById("lat").value);
            const lng = parseFloat(document.getElementById("lng").value);
            const date = document.getElementById("date").value;
            const eventName = document.getElementById("event-name").value;
            const message = document.getElementById("message").value;
            const imageUrl = document.getElementById("image-url").value;

            if (isNaN(lat) || isNaN(lng)) {
                showAlert("Please enter valid latitude and longitude.");
                return;
            }
            if (!date || !eventName || !message) {
                showAlert("Please fill in all required fields.");
                return;
            }

            const marker = new mapboxgl.Marker()
                .setLngLat([lng, lat])
                .addTo(map);

            const popupContent = `
                <h4>${eventName} - ${date}</h4>
                <p>${message}</p>
                ${imageUrl ? `<img src="${imageUrl}" style="max-width:200px; max-height:150px;" />` : ''}
            `;
            marker.setPopup(new mapboxgl.Popup().setHTML(popupContent));

            if (locations.length > 0) {
                const lastLocation = locations[locations.length - 1];
                const route = {
                    'type': 'FeatureCollection',
                    'features': [
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'LineString',
                                'coordinates': [[lastLocation.lng, lastLocation.lat], [lng, lat]]
                            }
                        }
                    ]
                };
                map.addSource(`route-${locations.length}`, { type: 'geojson', data: route });
                map.addLayer({
                    id: `route-layer-${locations.length}`,
                    type: 'line',
                    source: `route-${locations.length}`,
                    paint: {
                        'line-color': '#888',
                        'line-width': 5
                    }
                });
            }

            locations.push({ lat, lng, date, eventName, message, imageUrl });
            map.flyTo({ center: [lng, lat], zoom: 5 });
            clearForm();
        }

        function clearForm() {
            document.getElementById("lat").value = "";
            document.getElementById("lng").value = "";
            document.getElementById("date").value = "";
            document.getElementById("event-name").value = "";
            document.getElementById("message").value = "";
            document.getElementById("image-url").value = "";
        }
    </script>
</body>
</html>
